\hypertarget{gtest-death-test_8h_source}{}\doxysection{gtest-\/death-\/test.h}
\label{gtest-death-test_8h_source}\index{D:/vs\_project/Summer\_school/packages/Microsoft.googletest.v140.windesktop.msvcstl.static.rt-\/dyn.1.8.1.4/build/native/include/gtest/gtest-\/death-\/test.h@{D:/vs\_project/Summer\_school/packages/Microsoft.googletest.v140.windesktop.msvcstl.static.rt-\/dyn.1.8.1.4/build/native/include/gtest/gtest-\/death-\/test.h}}
\mbox{\hyperlink{gtest-death-test_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2005, Google Inc.}}
\DoxyCodeLine{2 \textcolor{comment}{// All rights reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Redistribution and use in source and binary forms, with or without}}
\DoxyCodeLine{5 \textcolor{comment}{// modification, are permitted provided that the following conditions are}}
\DoxyCodeLine{6 \textcolor{comment}{// met:}}
\DoxyCodeLine{7 \textcolor{comment}{//}}
\DoxyCodeLine{8 \textcolor{comment}{//     * Redistributions of source code must retain the above copyright}}
\DoxyCodeLine{9 \textcolor{comment}{// notice, this list of conditions and the following disclaimer.}}
\DoxyCodeLine{10 \textcolor{comment}{//     * Redistributions in binary form must reproduce the above}}
\DoxyCodeLine{11 \textcolor{comment}{// copyright notice, this list of conditions and the following disclaimer}}
\DoxyCodeLine{12 \textcolor{comment}{// in the documentation and/or other materials provided with the}}
\DoxyCodeLine{13 \textcolor{comment}{// distribution.}}
\DoxyCodeLine{14 \textcolor{comment}{//     * Neither the name of Google Inc. nor the names of its}}
\DoxyCodeLine{15 \textcolor{comment}{// contributors may be used to endorse or promote products derived from}}
\DoxyCodeLine{16 \textcolor{comment}{// this software without specific prior written permission.}}
\DoxyCodeLine{17 \textcolor{comment}{//}}
\DoxyCodeLine{18 \textcolor{comment}{// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS}}
\DoxyCodeLine{19 \textcolor{comment}{// "{}AS IS"{} AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT}}
\DoxyCodeLine{20 \textcolor{comment}{// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR}}
\DoxyCodeLine{21 \textcolor{comment}{// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT}}
\DoxyCodeLine{22 \textcolor{comment}{// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,}}
\DoxyCodeLine{23 \textcolor{comment}{// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT}}
\DoxyCodeLine{24 \textcolor{comment}{// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,}}
\DoxyCodeLine{25 \textcolor{comment}{// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY}}
\DoxyCodeLine{26 \textcolor{comment}{// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT}}
\DoxyCodeLine{27 \textcolor{comment}{// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE}}
\DoxyCodeLine{28 \textcolor{comment}{// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{comment}{//}}
\DoxyCodeLine{31 \textcolor{comment}{// The Google C++ Testing and Mocking Framework (Google Test)}}
\DoxyCodeLine{32 \textcolor{comment}{//}}
\DoxyCodeLine{33 \textcolor{comment}{// This header file defines the public API for death tests.  It is}}
\DoxyCodeLine{34 \textcolor{comment}{// \#included by gtest.h so a user doesn't need to include this}}
\DoxyCodeLine{35 \textcolor{comment}{// directly.}}
\DoxyCodeLine{36 \textcolor{comment}{// GOOGLETEST\_CM0001 DO NOT DELETE}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{preprocessor}{\#ifndef GTEST\_INCLUDE\_GTEST\_GTEST\_DEATH\_TEST\_H\_}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#define GTEST\_INCLUDE\_GTEST\_GTEST\_DEATH\_TEST\_H\_}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{gtest-death-test-internal_8h}{gtest/internal/gtest-\/death-\/test-\/internal.h}}"{}}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacetesting}{testing}} \{}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{comment}{// This flag controls the style of death tests.  Valid values are "{}threadsafe"{},}}
\DoxyCodeLine{46 \textcolor{comment}{// meaning that the death test child process will re-\/execute the test binary}}
\DoxyCodeLine{47 \textcolor{comment}{// from the start, running only a single death test, or "{}fast"{},}}
\DoxyCodeLine{48 \textcolor{comment}{// meaning that the child process will execute the test logic immediately}}
\DoxyCodeLine{49 \textcolor{comment}{// after forking.}}
\DoxyCodeLine{50 \mbox{\hyperlink{namespacetesting_a37b7e87f0a5f502c6918f37d1768c1f3}{GTEST\_DECLARE\_string\_}}(death\_test\_style);}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{preprocessor}{\#if GTEST\_HAS\_DEATH\_TEST}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{55 }
\DoxyCodeLine{56 \textcolor{comment}{// Returns a Boolean value indicating whether the caller is currently}}
\DoxyCodeLine{57 \textcolor{comment}{// executing in the context of the death test child process.  Tools such as}}
\DoxyCodeLine{58 \textcolor{comment}{// Valgrind heap checkers may need this to modify their behavior in death}}
\DoxyCodeLine{59 \textcolor{comment}{// tests.  IMPORTANT: This is an internal utility.  Using it may break the}}
\DoxyCodeLine{60 \textcolor{comment}{// implementation of death tests.  User code MUST NOT use it.}}
\DoxyCodeLine{61 \mbox{\hyperlink{gtest-port_8h_aa73be6f0ba4a7456180a94904ce17790}{GTEST\_API\_}} \textcolor{keywordtype}{bool} InDeathTestChild();}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \}  \textcolor{comment}{// namespace internal}}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{comment}{// The following macros are useful for writing death tests.}}
\DoxyCodeLine{66 }
\DoxyCodeLine{67 \textcolor{comment}{// Here's what happens when an ASSERT\_DEATH* or EXPECT\_DEATH* is}}
\DoxyCodeLine{68 \textcolor{comment}{// executed:}}
\DoxyCodeLine{69 \textcolor{comment}{//}}
\DoxyCodeLine{70 \textcolor{comment}{//   1. It generates a warning if there is more than one active}}
\DoxyCodeLine{71 \textcolor{comment}{//   thread.  This is because it's safe to fork() or clone() only}}
\DoxyCodeLine{72 \textcolor{comment}{//   when there is a single thread.}}
\DoxyCodeLine{73 \textcolor{comment}{//}}
\DoxyCodeLine{74 \textcolor{comment}{//   2. The parent process clone()s a sub-\/process and runs the death}}
\DoxyCodeLine{75 \textcolor{comment}{//   test in it; the sub-\/process exits with code 0 at the end of the}}
\DoxyCodeLine{76 \textcolor{comment}{//   death test, if it hasn't exited already.}}
\DoxyCodeLine{77 \textcolor{comment}{//}}
\DoxyCodeLine{78 \textcolor{comment}{//   3. The parent process waits for the sub-\/process to terminate.}}
\DoxyCodeLine{79 \textcolor{comment}{//}}
\DoxyCodeLine{80 \textcolor{comment}{//   4. The parent process checks the exit code and error message of}}
\DoxyCodeLine{81 \textcolor{comment}{//   the sub-\/process.}}
\DoxyCodeLine{82 \textcolor{comment}{//}}
\DoxyCodeLine{83 \textcolor{comment}{// Examples:}}
\DoxyCodeLine{84 \textcolor{comment}{//}}
\DoxyCodeLine{85 \textcolor{comment}{//   ASSERT\_DEATH(server.SendMessage(56, "{}Hello"{}), "{}Invalid port number"{});}}
\DoxyCodeLine{86 \textcolor{comment}{//   for (int i = 0; i < 5; i++) \{}}
\DoxyCodeLine{87 \textcolor{comment}{//     EXPECT\_DEATH(server.ProcessRequest(i),}}
\DoxyCodeLine{88 \textcolor{comment}{//                  "{}Invalid request .* in ProcessRequest()"{})}}
\DoxyCodeLine{89 \textcolor{comment}{//                  << "{}Failed to die on request "{} << i;}}
\DoxyCodeLine{90 \textcolor{comment}{//   \}}}
\DoxyCodeLine{91 \textcolor{comment}{//}}
\DoxyCodeLine{92 \textcolor{comment}{//   ASSERT\_EXIT(server.ExitNow(), ::testing::ExitedWithCode(0), "{}Exiting"{});}}
\DoxyCodeLine{93 \textcolor{comment}{//}}
\DoxyCodeLine{94 \textcolor{comment}{//   bool KilledBySIGHUP(int exit\_code) \{}}
\DoxyCodeLine{95 \textcolor{comment}{//     return WIFSIGNALED(exit\_code) \&\& WTERMSIG(exit\_code) == SIGHUP;}}
\DoxyCodeLine{96 \textcolor{comment}{//   \}}}
\DoxyCodeLine{97 \textcolor{comment}{//}}
\DoxyCodeLine{98 \textcolor{comment}{//   ASSERT\_EXIT(client.HangUpServer(), KilledBySIGHUP, "{}Hanging up!"{});}}
\DoxyCodeLine{99 \textcolor{comment}{//}}
\DoxyCodeLine{100 \textcolor{comment}{// On the regular expressions used in death tests:}}
\DoxyCodeLine{101 \textcolor{comment}{//}}
\DoxyCodeLine{102 \textcolor{comment}{//   GOOGLETEST\_CM0005 DO NOT DELETE}}
\DoxyCodeLine{103 \textcolor{comment}{//   On POSIX-\/compliant systems (*nix), we use the <regex.h> library,}}
\DoxyCodeLine{104 \textcolor{comment}{//   which uses the POSIX extended regex syntax.}}
\DoxyCodeLine{105 \textcolor{comment}{//}}
\DoxyCodeLine{106 \textcolor{comment}{//   On other platforms (e.g. Windows or Mac), we only support a simple regex}}
\DoxyCodeLine{107 \textcolor{comment}{//   syntax implemented as part of Google Test.  This limited}}
\DoxyCodeLine{108 \textcolor{comment}{//   implementation should be enough most of the time when writing}}
\DoxyCodeLine{109 \textcolor{comment}{//   death tests; though it lacks many features you can find in PCRE}}
\DoxyCodeLine{110 \textcolor{comment}{//   or POSIX extended regex syntax.  For example, we don't support}}
\DoxyCodeLine{111 \textcolor{comment}{//   union ("{}x|y"{}), grouping ("{}(xy)"{}), brackets ("{}[xy]"{}), and}}
\DoxyCodeLine{112 \textcolor{comment}{//   repetition count ("{}x\{5,7\}"{}), among others.}}
\DoxyCodeLine{113 \textcolor{comment}{//}}
\DoxyCodeLine{114 \textcolor{comment}{//   Below is the syntax that we do support.  We chose it to be a}}
\DoxyCodeLine{115 \textcolor{comment}{//   subset of both PCRE and POSIX extended regex, so it's easy to}}
\DoxyCodeLine{116 \textcolor{comment}{//   learn wherever you come from.  In the following: 'A' denotes a}}
\DoxyCodeLine{117 \textcolor{comment}{//   literal character, period (.), or a single \(\backslash\)\(\backslash\) escape sequence;}}
\DoxyCodeLine{118 \textcolor{comment}{//   'x' and 'y' denote regular expressions; 'm' and 'n' are for}}
\DoxyCodeLine{119 \textcolor{comment}{//   natural numbers.}}
\DoxyCodeLine{120 \textcolor{comment}{//}}
\DoxyCodeLine{121 \textcolor{comment}{//     c     matches any literal character c}}
\DoxyCodeLine{122 \textcolor{comment}{//     \(\backslash\)\(\backslash\)d   matches any decimal digit}}
\DoxyCodeLine{123 \textcolor{comment}{//     \(\backslash\)\(\backslash\)D   matches any character that's not a decimal digit}}
\DoxyCodeLine{124 \textcolor{comment}{//     \(\backslash\)\(\backslash\)f   matches \(\backslash\)f}}
\DoxyCodeLine{125 \textcolor{comment}{//     \(\backslash\)\(\backslash\)n   matches \(\backslash\)n}}
\DoxyCodeLine{126 \textcolor{comment}{//     \(\backslash\)\(\backslash\)r   matches \(\backslash\)r}}
\DoxyCodeLine{127 \textcolor{comment}{//     \(\backslash\)\(\backslash\)s   matches any ASCII whitespace, including \(\backslash\)n}}
\DoxyCodeLine{128 \textcolor{comment}{//     \(\backslash\)\(\backslash\)S   matches any character that's not a whitespace}}
\DoxyCodeLine{129 \textcolor{comment}{//     \(\backslash\)\(\backslash\)t   matches \(\backslash\)t}}
\DoxyCodeLine{130 \textcolor{comment}{//     \(\backslash\)\(\backslash\)v   matches \(\backslash\)v}}
\DoxyCodeLine{131 \textcolor{comment}{//     \(\backslash\)\(\backslash\)w   matches any letter, \_, or decimal digit}}
\DoxyCodeLine{132 \textcolor{comment}{//     \(\backslash\)\(\backslash\)W   matches any character that \(\backslash\)\(\backslash\)w doesn't match}}
\DoxyCodeLine{133 \textcolor{comment}{//     \(\backslash\)\(\backslash\)c   matches any literal character c, which must be a punctuation}}
\DoxyCodeLine{134 \textcolor{comment}{//     .     matches any single character except \(\backslash\)n}}
\DoxyCodeLine{135 \textcolor{comment}{//     A?    matches 0 or 1 occurrences of A}}
\DoxyCodeLine{136 \textcolor{comment}{//     A*    matches 0 or many occurrences of A}}
\DoxyCodeLine{137 \textcolor{comment}{//     A+    matches 1 or many occurrences of A}}
\DoxyCodeLine{138 \textcolor{comment}{//     \string^     matches the beginning of a string (not that of each line)}}
\DoxyCodeLine{139 \textcolor{comment}{//     \$     matches the end of a string (not that of each line)}}
\DoxyCodeLine{140 \textcolor{comment}{//     xy    matches x followed by y}}
\DoxyCodeLine{141 \textcolor{comment}{//}}
\DoxyCodeLine{142 \textcolor{comment}{//   If you accidentally use PCRE or POSIX extended regex features}}
\DoxyCodeLine{143 \textcolor{comment}{//   not implemented by us, you will get a run-\/time failure.  In that}}
\DoxyCodeLine{144 \textcolor{comment}{//   case, please try to rewrite your regular expression within the}}
\DoxyCodeLine{145 \textcolor{comment}{//   above syntax.}}
\DoxyCodeLine{146 \textcolor{comment}{//}}
\DoxyCodeLine{147 \textcolor{comment}{//   This implementation is *not* meant to be as highly tuned or robust}}
\DoxyCodeLine{148 \textcolor{comment}{//   as a compiled regex library, but should perform well enough for a}}
\DoxyCodeLine{149 \textcolor{comment}{//   death test, which already incurs significant overhead by launching}}
\DoxyCodeLine{150 \textcolor{comment}{//   a child process.}}
\DoxyCodeLine{151 \textcolor{comment}{//}}
\DoxyCodeLine{152 \textcolor{comment}{// Known caveats:}}
\DoxyCodeLine{153 \textcolor{comment}{//}}
\DoxyCodeLine{154 \textcolor{comment}{//   A "{}threadsafe"{} style death test obtains the path to the test}}
\DoxyCodeLine{155 \textcolor{comment}{//   program from argv[0] and re-\/executes it in the sub-\/process.  For}}
\DoxyCodeLine{156 \textcolor{comment}{//   simplicity, the current implementation doesn't search the PATH}}
\DoxyCodeLine{157 \textcolor{comment}{//   when launching the sub-\/process.  This means that the user must}}
\DoxyCodeLine{158 \textcolor{comment}{//   invoke the test program via a path that contains at least one}}
\DoxyCodeLine{159 \textcolor{comment}{//   path separator (e.g. path/to/foo\_test and}}
\DoxyCodeLine{160 \textcolor{comment}{//   /absolute/path/to/bar\_test are fine, but foo\_test is not).  This}}
\DoxyCodeLine{161 \textcolor{comment}{//   is rarely a problem as people usually don't put the test binary}}
\DoxyCodeLine{162 \textcolor{comment}{//   directory in PATH.}}
\DoxyCodeLine{163 \textcolor{comment}{//}}
\DoxyCodeLine{164 \textcolor{comment}{// FIXME: make thread-\/safe death tests search the PATH.}}
\DoxyCodeLine{165 }
\DoxyCodeLine{166 \textcolor{comment}{// Asserts that a given statement causes the program to exit, with an}}
\DoxyCodeLine{167 \textcolor{comment}{// integer exit status that satisfies predicate, and emitting error output}}
\DoxyCodeLine{168 \textcolor{comment}{// that matches regex.}}
\DoxyCodeLine{169 \textcolor{preprocessor}{\# define ASSERT\_EXIT(statement, predicate, regex) \(\backslash\)}}
\DoxyCodeLine{170 \textcolor{preprocessor}{    GTEST\_DEATH\_TEST\_(statement, predicate, regex, GTEST\_FATAL\_FAILURE\_)}}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 \textcolor{comment}{// Like ASSERT\_EXIT, but continues on to successive tests in the}}
\DoxyCodeLine{173 \textcolor{comment}{// test case, if any:}}
\DoxyCodeLine{174 \textcolor{preprocessor}{\# define EXPECT\_EXIT(statement, predicate, regex) \(\backslash\)}}
\DoxyCodeLine{175 \textcolor{preprocessor}{    GTEST\_DEATH\_TEST\_(statement, predicate, regex, GTEST\_NONFATAL\_FAILURE\_)}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 \textcolor{comment}{// Asserts that a given statement causes the program to exit, either by}}
\DoxyCodeLine{178 \textcolor{comment}{// explicitly exiting with a nonzero exit code or being killed by a}}
\DoxyCodeLine{179 \textcolor{comment}{// signal, and emitting error output that matches regex.}}
\DoxyCodeLine{180 \textcolor{preprocessor}{\# define ASSERT\_DEATH(statement, regex) \(\backslash\)}}
\DoxyCodeLine{181 \textcolor{preprocessor}{    ASSERT\_EXIT(statement, ::testing::internal::ExitedUnsuccessfully, regex)}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 \textcolor{comment}{// Like ASSERT\_DEATH, but continues on to successive tests in the}}
\DoxyCodeLine{184 \textcolor{comment}{// test case, if any:}}
\DoxyCodeLine{185 \textcolor{preprocessor}{\# define EXPECT\_DEATH(statement, regex) \(\backslash\)}}
\DoxyCodeLine{186 \textcolor{preprocessor}{    EXPECT\_EXIT(statement, ::testing::internal::ExitedUnsuccessfully, regex)}}
\DoxyCodeLine{187 }
\DoxyCodeLine{188 \textcolor{comment}{// Two predicate classes that can be used in \{ASSERT,EXPECT\}\_EXIT*:}}
\DoxyCodeLine{189 }
\DoxyCodeLine{190 \textcolor{comment}{// Tests that an exit code describes a normal exit with a given exit code.}}
\DoxyCodeLine{191 \textcolor{keyword}{class }\mbox{\hyperlink{gtest-port_8h_aa73be6f0ba4a7456180a94904ce17790}{GTEST\_API\_}} ExitedWithCode \{}
\DoxyCodeLine{192  \textcolor{keyword}{public}:}
\DoxyCodeLine{193   \textcolor{keyword}{explicit} ExitedWithCode(\textcolor{keywordtype}{int} exit\_code);}
\DoxyCodeLine{194   \textcolor{keywordtype}{bool} operator()(\textcolor{keywordtype}{int} exit\_status) \textcolor{keyword}{const};}
\DoxyCodeLine{195  \textcolor{keyword}{private}:}
\DoxyCodeLine{196   \textcolor{comment}{// No implementation -\/ assignment is unsupported.}}
\DoxyCodeLine{197   \textcolor{keywordtype}{void} operator=(\textcolor{keyword}{const} ExitedWithCode\& other);}
\DoxyCodeLine{198 }
\DoxyCodeLine{199   \textcolor{keyword}{const} \textcolor{keywordtype}{int} exit\_code\_;}
\DoxyCodeLine{200 \};}
\DoxyCodeLine{201 }
\DoxyCodeLine{202 \textcolor{preprocessor}{\# if !GTEST\_OS\_WINDOWS \&\& !GTEST\_OS\_FUCHSIA}}
\DoxyCodeLine{203 \textcolor{comment}{// Tests that an exit code describes an exit due to termination by a}}
\DoxyCodeLine{204 \textcolor{comment}{// given signal.}}
\DoxyCodeLine{205 \textcolor{comment}{// GOOGLETEST\_CM0006 DO NOT DELETE}}
\DoxyCodeLine{206 \textcolor{keyword}{class }\mbox{\hyperlink{gtest-port_8h_aa73be6f0ba4a7456180a94904ce17790}{GTEST\_API\_}} KilledBySignal \{}
\DoxyCodeLine{207  \textcolor{keyword}{public}:}
\DoxyCodeLine{208   \textcolor{keyword}{explicit} KilledBySignal(\textcolor{keywordtype}{int} signum);}
\DoxyCodeLine{209   \textcolor{keywordtype}{bool} operator()(\textcolor{keywordtype}{int} exit\_status) \textcolor{keyword}{const};}
\DoxyCodeLine{210  \textcolor{keyword}{private}:}
\DoxyCodeLine{211   \textcolor{keyword}{const} \textcolor{keywordtype}{int} signum\_;}
\DoxyCodeLine{212 \};}
\DoxyCodeLine{213 \textcolor{preprocessor}{\# endif  }\textcolor{comment}{// !GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{214 }
\DoxyCodeLine{215 \textcolor{comment}{// EXPECT\_DEBUG\_DEATH asserts that the given statements die in debug mode.}}
\DoxyCodeLine{216 \textcolor{comment}{// The death testing framework causes this to have interesting semantics,}}
\DoxyCodeLine{217 \textcolor{comment}{// since the sideeffects of the call are only visible in opt mode, and not}}
\DoxyCodeLine{218 \textcolor{comment}{// in debug mode.}}
\DoxyCodeLine{219 \textcolor{comment}{//}}
\DoxyCodeLine{220 \textcolor{comment}{// In practice, this can be used to test functions that utilize the}}
\DoxyCodeLine{221 \textcolor{comment}{// LOG(DFATAL) macro using the following style:}}
\DoxyCodeLine{222 \textcolor{comment}{//}}
\DoxyCodeLine{223 \textcolor{comment}{// int DieInDebugOr12(int* sideeffect) \{}}
\DoxyCodeLine{224 \textcolor{comment}{//   if (sideeffect) \{}}
\DoxyCodeLine{225 \textcolor{comment}{//     *sideeffect = 12;}}
\DoxyCodeLine{226 \textcolor{comment}{//   \}}}
\DoxyCodeLine{227 \textcolor{comment}{//   LOG(DFATAL) << "{}death"{};}}
\DoxyCodeLine{228 \textcolor{comment}{//   return 12;}}
\DoxyCodeLine{229 \textcolor{comment}{// \}}}
\DoxyCodeLine{230 \textcolor{comment}{//}}
\DoxyCodeLine{231 \textcolor{comment}{// TEST(TestCase, TestDieOr12WorksInDgbAndOpt) \{}}
\DoxyCodeLine{232 \textcolor{comment}{//   int sideeffect = 0;}}
\DoxyCodeLine{233 \textcolor{comment}{//   // Only asserts in dbg.}}
\DoxyCodeLine{234 \textcolor{comment}{//   EXPECT\_DEBUG\_DEATH(DieInDebugOr12(\&sideeffect), "{}death"{});}}
\DoxyCodeLine{235 \textcolor{comment}{//}}
\DoxyCodeLine{236 \textcolor{comment}{// \#ifdef NDEBUG}}
\DoxyCodeLine{237 \textcolor{comment}{//   // opt-\/mode has sideeffect visible.}}
\DoxyCodeLine{238 \textcolor{comment}{//   EXPECT\_EQ(12, sideeffect);}}
\DoxyCodeLine{239 \textcolor{comment}{// \#else}}
\DoxyCodeLine{240 \textcolor{comment}{//   // dbg-\/mode no visible sideeffect.}}
\DoxyCodeLine{241 \textcolor{comment}{//   EXPECT\_EQ(0, sideeffect);}}
\DoxyCodeLine{242 \textcolor{comment}{// \#endif}}
\DoxyCodeLine{243 \textcolor{comment}{// \}}}
\DoxyCodeLine{244 \textcolor{comment}{//}}
\DoxyCodeLine{245 \textcolor{comment}{// This will assert that DieInDebugReturn12InOpt() crashes in debug}}
\DoxyCodeLine{246 \textcolor{comment}{// mode, usually due to a DCHECK or LOG(DFATAL), but returns the}}
\DoxyCodeLine{247 \textcolor{comment}{// appropriate fallback value (12 in this case) in opt mode. If you}}
\DoxyCodeLine{248 \textcolor{comment}{// need to test that a function has appropriate side-\/effects in opt}}
\DoxyCodeLine{249 \textcolor{comment}{// mode, include assertions against the side-\/effects.  A general}}
\DoxyCodeLine{250 \textcolor{comment}{// pattern for this is:}}
\DoxyCodeLine{251 \textcolor{comment}{//}}
\DoxyCodeLine{252 \textcolor{comment}{// EXPECT\_DEBUG\_DEATH(\{}}
\DoxyCodeLine{253 \textcolor{comment}{//   // Side-\/effects here will have an effect after this statement in}}
\DoxyCodeLine{254 \textcolor{comment}{//   // opt mode, but none in debug mode.}}
\DoxyCodeLine{255 \textcolor{comment}{//   EXPECT\_EQ(12, DieInDebugOr12(\&sideeffect));}}
\DoxyCodeLine{256 \textcolor{comment}{// \}, "{}death"{});}}
\DoxyCodeLine{257 \textcolor{comment}{//}}
\DoxyCodeLine{258 \textcolor{preprocessor}{\# ifdef NDEBUG}}
\DoxyCodeLine{259 }
\DoxyCodeLine{260 \textcolor{preprocessor}{\#  define EXPECT\_DEBUG\_DEATH(statement, regex) \(\backslash\)}}
\DoxyCodeLine{261 \textcolor{preprocessor}{  GTEST\_EXECUTE\_STATEMENT\_(statement, regex)}}
\DoxyCodeLine{262 }
\DoxyCodeLine{263 \textcolor{preprocessor}{\#  define ASSERT\_DEBUG\_DEATH(statement, regex) \(\backslash\)}}
\DoxyCodeLine{264 \textcolor{preprocessor}{  GTEST\_EXECUTE\_STATEMENT\_(statement, regex)}}
\DoxyCodeLine{265 }
\DoxyCodeLine{266 \textcolor{preprocessor}{\# else}}
\DoxyCodeLine{267 }
\DoxyCodeLine{268 \textcolor{preprocessor}{\#  define EXPECT\_DEBUG\_DEATH(statement, regex) \(\backslash\)}}
\DoxyCodeLine{269 \textcolor{preprocessor}{  EXPECT\_DEATH(statement, regex)}}
\DoxyCodeLine{270 }
\DoxyCodeLine{271 \textcolor{preprocessor}{\#  define ASSERT\_DEBUG\_DEATH(statement, regex) \(\backslash\)}}
\DoxyCodeLine{272 \textcolor{preprocessor}{  ASSERT\_DEATH(statement, regex)}}
\DoxyCodeLine{273 }
\DoxyCodeLine{274 \textcolor{preprocessor}{\# endif  }\textcolor{comment}{// NDEBUG for EXPECT\_DEBUG\_DEATH}}
\DoxyCodeLine{275 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// GTEST\_HAS\_DEATH\_TEST}}
\DoxyCodeLine{276 }
\DoxyCodeLine{277 \textcolor{comment}{// This macro is used for implementing macros such as}}
\DoxyCodeLine{278 \textcolor{comment}{// EXPECT\_DEATH\_IF\_SUPPORTED and ASSERT\_DEATH\_IF\_SUPPORTED on systems where}}
\DoxyCodeLine{279 \textcolor{comment}{// death tests are not supported. Those macros must compile on such systems}}
\DoxyCodeLine{280 \textcolor{comment}{// iff EXPECT\_DEATH and ASSERT\_DEATH compile with the same parameters on}}
\DoxyCodeLine{281 \textcolor{comment}{// systems that support death tests. This allows one to write such a macro}}
\DoxyCodeLine{282 \textcolor{comment}{// on a system that does not support death tests and be sure that it will}}
\DoxyCodeLine{283 \textcolor{comment}{// compile on a death-\/test supporting system. It is exposed publicly so that}}
\DoxyCodeLine{284 \textcolor{comment}{// systems that have death-\/tests with stricter requirements than}}
\DoxyCodeLine{285 \textcolor{comment}{// GTEST\_HAS\_DEATH\_TEST can write their own equivalent of}}
\DoxyCodeLine{286 \textcolor{comment}{// EXPECT\_DEATH\_IF\_SUPPORTED and ASSERT\_DEATH\_IF\_SUPPORTED.}}
\DoxyCodeLine{287 \textcolor{comment}{//}}
\DoxyCodeLine{288 \textcolor{comment}{// Parameters:}}
\DoxyCodeLine{289 \textcolor{comment}{//   statement -\/  A statement that a macro such as EXPECT\_DEATH would test}}
\DoxyCodeLine{290 \textcolor{comment}{//                for program termination. This macro has to make sure this}}
\DoxyCodeLine{291 \textcolor{comment}{//                statement is compiled but not executed, to ensure that}}
\DoxyCodeLine{292 \textcolor{comment}{//                EXPECT\_DEATH\_IF\_SUPPORTED compiles with a certain}}
\DoxyCodeLine{293 \textcolor{comment}{//                parameter iff EXPECT\_DEATH compiles with it.}}
\DoxyCodeLine{294 \textcolor{comment}{//   regex     -\/  A regex that a macro such as EXPECT\_DEATH would use to test}}
\DoxyCodeLine{295 \textcolor{comment}{//                the output of statement.  This parameter has to be}}
\DoxyCodeLine{296 \textcolor{comment}{//                compiled but not evaluated by this macro, to ensure that}}
\DoxyCodeLine{297 \textcolor{comment}{//                this macro only accepts expressions that a macro such as}}
\DoxyCodeLine{298 \textcolor{comment}{//                EXPECT\_DEATH would accept.}}
\DoxyCodeLine{299 \textcolor{comment}{//   terminator -\/ Must be an empty statement for EXPECT\_DEATH\_IF\_SUPPORTED}}
\DoxyCodeLine{300 \textcolor{comment}{//                and a return statement for ASSERT\_DEATH\_IF\_SUPPORTED.}}
\DoxyCodeLine{301 \textcolor{comment}{//                This ensures that ASSERT\_DEATH\_IF\_SUPPORTED will not}}
\DoxyCodeLine{302 \textcolor{comment}{//                compile inside functions where ASSERT\_DEATH doesn't}}
\DoxyCodeLine{303 \textcolor{comment}{//                compile.}}
\DoxyCodeLine{304 \textcolor{comment}{//}}
\DoxyCodeLine{305 \textcolor{comment}{//  The branch that has an always false condition is used to ensure that}}
\DoxyCodeLine{306 \textcolor{comment}{//  statement and regex are compiled (and thus syntactically correct) but}}
\DoxyCodeLine{307 \textcolor{comment}{//  never executed. The unreachable code macro protects the terminator}}
\DoxyCodeLine{308 \textcolor{comment}{//  statement from generating an 'unreachable code' warning in case}}
\DoxyCodeLine{309 \textcolor{comment}{//  statement unconditionally returns or throws. The Message constructor at}}
\DoxyCodeLine{310 \textcolor{comment}{//  the end allows the syntax of streaming additional messages into the}}
\DoxyCodeLine{311 \textcolor{comment}{//  macro, for compilational compatibility with EXPECT\_DEATH/ASSERT\_DEATH.}}
\DoxyCodeLine{312 \textcolor{preprocessor}{\# define GTEST\_UNSUPPORTED\_DEATH\_TEST(statement, regex, terminator) \(\backslash\)}}
\DoxyCodeLine{313 \textcolor{preprocessor}{    GTEST\_AMBIGUOUS\_ELSE\_BLOCKER\_ \(\backslash\)}}
\DoxyCodeLine{314 \textcolor{preprocessor}{    if (::testing::internal::AlwaysTrue()) \{ \(\backslash\)}}
\DoxyCodeLine{315 \textcolor{preprocessor}{      GTEST\_LOG\_(WARNING) \(\backslash\)}}
\DoxyCodeLine{316 \textcolor{preprocessor}{          << "{}Death tests are not supported on this platform.\(\backslash\)n"{}} \(\backslash\)}
\DoxyCodeLine{317           << "{}Statement '"{} \#statement "{}' cannot be verified."{}; \(\backslash\)}
\DoxyCodeLine{318     \} else if (::testing::internal::AlwaysFalse()) \{ \(\backslash\)}
\DoxyCodeLine{319       ::testing::internal::RE::PartialMatch("{}.*"{}, (regex)); \(\backslash\)}
\DoxyCodeLine{320       GTEST\_SUPPRESS\_UNREACHABLE\_CODE\_WARNING\_BELOW\_(statement); \(\backslash\)}
\DoxyCodeLine{321       terminator; \(\backslash\)}
\DoxyCodeLine{322     \} else \(\backslash\)}
\DoxyCodeLine{323       ::testing::Message()}
\DoxyCodeLine{324 }
\DoxyCodeLine{325 \textcolor{comment}{// EXPECT\_DEATH\_IF\_SUPPORTED(statement, regex) and}}
\DoxyCodeLine{326 \textcolor{comment}{// ASSERT\_DEATH\_IF\_SUPPORTED(statement, regex) expand to real death tests if}}
\DoxyCodeLine{327 \textcolor{comment}{// death tests are supported; otherwise they just issue a warning.  This is}}
\DoxyCodeLine{328 \textcolor{comment}{// useful when you are combining death test assertions with normal test}}
\DoxyCodeLine{329 \textcolor{comment}{// assertions in one test.}}
\DoxyCodeLine{330 \textcolor{preprocessor}{\#if GTEST\_HAS\_DEATH\_TEST}}
\DoxyCodeLine{331 \textcolor{preprocessor}{\# define EXPECT\_DEATH\_IF\_SUPPORTED(statement, regex) \(\backslash\)}}
\DoxyCodeLine{332 \textcolor{preprocessor}{    EXPECT\_DEATH(statement, regex)}}
\DoxyCodeLine{333 \textcolor{preprocessor}{\# define ASSERT\_DEATH\_IF\_SUPPORTED(statement, regex) \(\backslash\)}}
\DoxyCodeLine{334 \textcolor{preprocessor}{    ASSERT\_DEATH(statement, regex)}}
\DoxyCodeLine{335 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{336 \textcolor{preprocessor}{\# define EXPECT\_DEATH\_IF\_SUPPORTED(statement, regex) \(\backslash\)}}
\DoxyCodeLine{337 \textcolor{preprocessor}{    GTEST\_UNSUPPORTED\_DEATH\_TEST(statement, regex, )}}
\DoxyCodeLine{338 \textcolor{preprocessor}{\# define ASSERT\_DEATH\_IF\_SUPPORTED(statement, regex) \(\backslash\)}}
\DoxyCodeLine{339 \textcolor{preprocessor}{    GTEST\_UNSUPPORTED\_DEATH\_TEST(statement, regex, return)}}
\DoxyCodeLine{340 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{341 }
\DoxyCodeLine{342 \}  \textcolor{comment}{// namespace testing}}
\DoxyCodeLine{343 }
\DoxyCodeLine{344 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// GTEST\_INCLUDE\_GTEST\_GTEST\_DEATH\_TEST\_H\_}}

\end{DoxyCode}
